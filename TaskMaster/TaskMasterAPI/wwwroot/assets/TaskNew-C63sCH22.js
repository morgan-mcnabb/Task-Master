import{q as $,i as o,a as c,b as t,d as b,n as y,m as T,h as S,v as h,t as r,x as F,F as L,s as O,f as R,w as A,p as B,r as P,k as X,o as g}from"./index-CaANifo-.js";import{c as C,a as V,_}from"./tasks-BO7GUg6L.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"mx-auto max-w-3xl p-6 space-y-6"},z={key:0,class:"mt-1 text-sm text-red-600"},K={key:0,class:"mt-1 text-sm text-red-600"},G={class:"grid gap-4 md:grid-cols-2"},H=["value"],J={key:0,class:"mt-1 text-sm text-red-600"},Q={class:"flex items-center gap-3"},W=["disabled"],D=120,M=2e3,se={__name:"TaskNew",setup(Y){const q=X(),I=$(),n=o(""),i=o(""),w=o(C.includes("Medium")?"Medium":C[0]),k=o(""),u=o([]),a=o({title:"",description:"",tags:""});function N(l){const e=l.map(s=>s.toLowerCase());return new Set(e).size===e.length}function U(){a.value={title:"",description:"",tags:""};const l=n.value.trim();l?l.length>D&&(a.value.title=`Title must be at most ${D} characters.`):a.value.title="Title is required.";const e=i.value.trim();return e&&e.length>M&&(a.value.description=`Description must be at most ${M} characters.`),N(u.value)||(a.value.tags="Tags must be unique (case-insensitive)."),Object.values(a.value).every(v=>!v)}const p=o(!1),f=o({show:!1,message:""}),d=o({show:!1,message:"",correlationId:""});async function E(){n.value=n.value.trim(),i.value=i.value.trim();const l=new Set,e=[];for(const m of u.value){const x=m.toLowerCase();l.has(x)||(l.add(x),e.push(m))}if(u.value=e,!U())return;p.value=!0,d.value={show:!1,message:"",correlationId:""};const s={title:n.value,description:i.value||void 0,priority:w.value,dueDate:k.value||null,tags:u.value};try{const m=await I.createTaskFull(s);f.value={show:!0,message:"Task created successfully."},setTimeout(()=>{q.push({name:"task-details",params:{id:m.id}})},600)}catch(m){const x=I.errorCorrelationId||"";d.value={show:!0,message:m?.message??"Failed to create task.",correlationId:x}}finally{p.value=!1}}return(l,e)=>{const v=P("router-link");return g(),c("section",j,[e[15]||(e[15]=t("header",{class:"space-y-1"},[t("h1",{class:"text-2xl font-semibold"},"New Task"),t("p",{class:"text-gray-600"},"Create a task with details and tags.")],-1)),b(V,{show:f.value.show,title:"Success",message:f.value.message,variant:"success",onClose:e[0]||(e[0]=s=>f.value.show=!1)},null,8,["show","message"]),b(V,{show:d.value.show,title:"Could not create task",message:d.value.message,"correlation-id":d.value.correlationId,variant:"error",onClose:e[1]||(e[1]=s=>d.value.show=!1)},null,8,["show","message","correlation-id"]),t("form",{onSubmit:B(E,["prevent"]),class:"space-y-6 rounded-lg border border-gray-200 bg-white p-5 shadow-sm"},[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700"},[S("Title "),t("span",{class:"text-red-600"},"*")],-1)),y(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>n.value=s),type:"text",maxlength:"120",placeholder:"Short, clear title",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[h,n.value]]),a.value.title?(g(),c("p",z,r(a.value.title),1)):T("",!0),e[8]||(e[8]=t("p",{class:"mt-1 text-xs text-gray-500"},"Max "+r(120)+" characters.",-1))]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700"},"Description",-1)),y(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>i.value=s),rows:"4",maxlength:"2000",placeholder:"Optional details",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[h,i.value]]),a.value.description?(g(),c("p",K,r(a.value.description),1)):T("",!0),e[10]||(e[10]=t("p",{class:"mt-1 text-xs text-gray-500"},"Max "+r(2e3)+" characters.",-1))]),t("div",G,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Priority",-1)),y(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>w.value=s),class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},[(g(!0),c(L,null,O(R(C),s=>(g(),c("option",{key:s,value:s},r(s),9,H))),128))],512),[[F,w.value]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"Due date",-1)),y(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>k.value=s),type:"date",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[h,k.value]])])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"},"Tags",-1)),b(_,{modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=s=>u.value=s),limit:10},null,8,["modelValue"]),a.value.tags?(g(),c("p",J,r(a.value.tags),1)):T("",!0)]),t("div",Q,[t("button",{type:"submit",disabled:p.value,class:"rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-50"},r(p.value?"Creatingâ€¦":"Create task"),9,W),b(v,{to:{name:"tasks"},class:"text-sm text-gray-700 underline"},{default:A(()=>[...e[14]||(e[14]=[S(" Cancel ",-1)])]),_:1})])],32)])}}};export{se as default};
