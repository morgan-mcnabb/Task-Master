import{n as A,r as l,B as w,c as m,b as t,h as T,e as x,d as k,g as I,v as S,t as r,s as R,F as O,x as _,j as V,i as B,f as F,l as L,a as $,m as c,R as h}from"./index-CTgWvdHK.js";import{T as K,_ as P}from"./TagPicker-Bqnf6D6L.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"mx-auto max-w-3xl p-6 space-y-6"},X={key:0,class:"mt-1 text-sm text-red-600"},z={key:0,class:"mt-1 text-sm text-red-600"},G={class:"grid gap-4 md:grid-cols-2"},H=["value"],J={key:0,class:"mt-1 text-sm text-red-600"},Q={class:"flex items-center gap-3"},W=["disabled"],M=120,D=2e3,se={__name:"TaskNew",setup(Y){const N=$(),C=A(),n=l(""),i=l(""),b=l(w.includes("Medium")?"Medium":w[0]),y=l(""),u=l([]),a=l({title:"",description:"",tags:""});function E(o){const e=o.map(s=>s.toLowerCase());return new Set(e).size===e.length}function U(){a.value={title:"",description:"",tags:""};const o=n.value.trim();o?o.length>M&&(a.value.title=`Title must be at most ${M} characters.`):a.value.title="Title is required.";const e=i.value.trim();return e&&e.length>D&&(a.value.description=`Description must be at most ${D} characters.`),E(u.value)||(a.value.tags="Tags must be unique (case-insensitive)."),Object.values(a.value).every(g=>!g)}const p=l(!1),d=l({show:!1,message:"",correlationId:""});async function q(){n.value=n.value.trim(),i.value=i.value.trim();const o=new Set,e=[];for(const v of u.value){const f=v.toLowerCase();o.has(f)||(o.add(f),e.push(v))}if(u.value=e,!U())return;p.value=!0,d.value={show:!1,message:"",correlationId:""};const s={title:n.value,description:i.value||void 0,priority:b.value,dueDate:y.value||null,tags:u.value};try{await C.createTaskFull(s),await N.replace({name:h.TASKS})}catch(v){const f=C.errorCorrelationId||"";d.value={show:!0,message:v?.message??"Failed to create task.",correlationId:f}}finally{p.value=!1}}return(o,e)=>{const g=L("router-link");return c(),m("section",j,[e[14]||(e[14]=t("header",{class:"space-y-1"},[t("h1",{class:"text-2xl font-semibold"},"New Task"),t("p",{class:"text-gray-600"},"Create a task with details and tags.")],-1)),T(K,{show:d.value.show,title:"Could not create task",message:d.value.message,"correlation-id":d.value.correlationId,variant:"error",onClose:e[0]||(e[0]=s=>d.value.show=!1)},null,8,["show","message","correlation-id"]),t("form",{onSubmit:F(q,["prevent"]),class:"space-y-6 rounded-lg border border-gray-200 bg-white p-5 shadow-sm"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700"},[I("Title "),t("span",{class:"text-red-600"},"*")],-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.value=s),type:"text",maxlength:"120",placeholder:"Short, clear title",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[S,n.value]]),a.value.title?(c(),m("p",X,r(a.value.title),1)):k("",!0),e[7]||(e[7]=t("p",{class:"mt-1 text-xs text-gray-500"},"Max "+r(120)+" characters.",-1))]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700"},"Description",-1)),x(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s),rows:"4",maxlength:"2000",placeholder:"Optional details",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[S,i.value]]),a.value.description?(c(),m("p",z,r(a.value.description),1)):k("",!0),e[9]||(e[9]=t("p",{class:"mt-1 text-xs text-gray-500"},"Max "+r(2e3)+" characters.",-1))]),t("div",G,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700"},"Priority",-1)),x(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),class:"mt-1 w-full rounded-md border border-gray-300 pl-3 pr-8 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},[(c(!0),m(O,null,_(V(w),s=>(c(),m("option",{key:s,value:s},r(s),9,H))),128))],512),[[R,b.value]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Due date",-1)),x(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>y.value=s),type:"date",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[S,y.value]])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"Tags",-1)),T(P,{modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=s=>u.value=s),limit:10},null,8,["modelValue"]),a.value.tags?(c(),m("p",J,r(a.value.tags),1)):k("",!0)]),t("div",Q,[t("button",{type:"submit",disabled:p.value,class:"rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-50"},r(p.value?"Creatingâ€¦":"Create task"),9,W),T(g,{to:{name:V(h).TASKS},class:"text-sm text-gray-700 underline"},{default:B(()=>[...e[13]||(e[13]=[I(" Cancel ",-1)])]),_:1},8,["to"])])],32)])}}};export{se as default};
