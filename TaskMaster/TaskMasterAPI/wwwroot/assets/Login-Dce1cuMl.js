import{f as k,g as u,h as R,i as _,j as q,c as p,a as t,k as N,l as g,v as f,t as v,m as T,e as y,b as V,w as A,u as x,d as E,R as b,r as M,o as w}from"./index-Ct3dq3h5.js";const U={class:"mx-auto max-w-md p-6 space-y-6"},C={key:0,class:"text-sm text-red-600"},L=["disabled"],B={class:"text-sm text-gray-600"},G={__name:"Login",setup(D){const l=k(),s=E(),d=_(),a=u(""),r=u(""),n=u(!1),o=u("");function c(){return typeof s.query.redirect=="string"&&s.query.redirect?s.query.redirect:{name:b.TASKS}}async function S(){if(!a.value||!r.value){o.value="Username and password are required.";return}n.value=!0,o.value="";try{await l.login(a.value,r.value),await d.replace(c())}catch(i){o.value=i?.message??"Login failed."}finally{n.value=!1}}return R(()=>{l.isAuthenticated&&d.replace(c())}),q(()=>l.isAuthenticated,i=>{i&&d.replace(c())}),(i,e)=>{const h=M("router-link");return w(),p("section",U,[e[6]||(e[6]=t("header",null,[t("h1",{class:"text-2xl font-semibold"},"Login"),t("p",{class:"text-gray-600"},"Sign in to your account")],-1)),t("form",{onSubmit:T(S,["prevent"]),class:"space-y-4"},[t("div",null,[e[2]||(e[2]=t("label",{class:"block text-sm font-medium text-gray-700"},"Username",-1)),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=m=>a.value=m),type:"text",autocomplete:"username",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[f,a.value]])]),t("div",null,[e[3]||(e[3]=t("label",{class:"block text-sm font-medium text-gray-700"},"Password",-1)),g(t("input",{"onUpdate:modelValue":e[1]||(e[1]=m=>r.value=m),type:"password",autocomplete:"current-password",class:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},null,512),[[f,r.value]])]),o.value?(w(),p("p",C,v(o.value),1)):N("",!0),t("button",{type:"submit",disabled:n.value,class:"w-full rounded-md bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700 disabled:opacity-50"},v(n.value?"Signing in…":"Sign in"),9,L)],32),t("p",B,[e[5]||(e[5]=y(" Don’t have an account? ",-1)),V(h,{to:{name:x(b).REGISTER,query:{redirect:x(s).query.redirect??void 0}},class:"text-indigo-600 hover:text-indigo-700"},{default:A(()=>[...e[4]||(e[4]=[y(" Create one ",-1)])]),_:1},8,["to"])])])}}};export{G as default};
