import{e as K,o as d,w as U,a as m,m as k,b as c,t as S,A as F,T as G,B as H,C as Z,i as h,c as J,D,l as E,j as Q,F as z,s as O,n as W,v as X,p as Y,E as q}from"./index-CaANifo-.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"flex items-start justify-between gap-3"},ne={key:0,class:"text-sm font-semibold"},oe={class:"mt-1 text-sm"},ae={key:1,class:"mt-2 flex items-center gap-2"},se={class:"rounded bg-white/50 px-1.5 py-0.5 text-xs"},le={__name:"Toast",props:{title:{type:String,default:""},message:{type:String,default:""},correlationId:{type:String,default:""},variant:{type:String,default:"error"},show:{type:Boolean,default:!1}},emits:["close"],setup(a,{emit:l}){const r=a,y=l;function p(){if(r.correlationId)try{navigator.clipboard.writeText(r.correlationId)}catch{}}return(i,o)=>(d(),K(G,{name:"fade"},{default:U(()=>[a.show?(d(),m("div",{key:0,class:F(["fixed right-4 top-4 z-50 w-[28rem] max-w-[90vw] rounded-lg border p-4 shadow-lg",{"bg-red-50 border-red-200 text-red-800":a.variant==="error","bg-blue-50 border-blue-200 text-blue-800":a.variant==="info","bg-green-50 border-green-200 text-green-800":a.variant==="success"}]),role:"alert"},[c("div",te,[c("div",null,[a.title?(d(),m("div",ne,S(a.title),1)):k("",!0),c("div",oe,S(a.message),1),a.correlationId?(d(),m("div",ae,[o[1]||(o[1]=c("span",{class:"text-xs opacity-80"},"Correlation ID:",-1)),c("code",se,S(a.correlationId),1),c("button",{class:"text-xs underline",onClick:p},"Copy")])):k("",!0)]),c("button",{class:"text-sm underline opacity-70 hover:opacity-100",onClick:o[0]||(o[0]=s=>y("close"))}," Dismiss ")])],2)):k("",!0)]),_:1}))}},Se=ee(le,[["__scopeId","data-v-4209b5bb"]]);function re(a,l=300,r={}){const{leading:y=!1,trailing:p=!0}=r;let i=null,o=null,s=null,g=!1;const f=()=>{const v=o,x=s;o=s=null,a.apply(x,v)};function u(...v){o=v,s=this,i&&clearTimeout(i),y&&!g&&(g=!0,a.apply(s,o),o=s=null),i=setTimeout(()=>{i=null,g=!1,p&&o&&f()},l)}return u.cancel=()=>{i&&clearTimeout(i),i=null,o=s=null,g=!1},u.flush=()=>{i&&(clearTimeout(i),i=null,p&&o&&f(),g=!1)},u}function ie(a){let l=null;function r(...i){l&&l.abort(),l=new AbortController;const o=l.signal;return{promise:Promise.resolve().then(()=>a({signal:o},...i)).finally(()=>{l&&l.signal===o&&(l=null)}),signal:o}}function y(){l&&(l.abort(),l=null)}function p(){return l?l.signal:null}return{run:r,abort:y,getSignal:p}}function ue(){const a=H(Z,null);if(!a)throw new Error("API client was not provided. Ensure main.js provides ApiClientKey.");return a}const ce={id:"tag-picker-root",class:"w-full"},de={class:"flex flex-wrap items-center gap-2"},fe=["disabled","onClick"],me={class:"relative"},ge=["placeholder","disabled"],pe={key:0,class:"absolute z-10 mt-1 max-h-48 w-56 overflow-auto rounded-md border border-gray-200 bg-white shadow",role:"listbox"},ve={key:0,class:"px-3 py-2 text-sm text-gray-500"},be={key:1,class:"px-3 py-2 text-sm text-red-600"},ye=["onMousedown"],Te={__name:"TagPicker",props:{modelValue:{type:Array,default:()=>[]},placeholder:{type:String,default:"Add tag…"},limit:{type:Number,default:10},debounceMs:{type:Number,default:250},disabled:{type:Boolean,default:!1},fetcher:{type:Function,default:null}},emits:["update:modelValue"],setup(a,{emit:l}){const r=a,y=l,p=ue(),i=h(null),o=h(""),s=h([]),g=h(!1),f=h(!1),u=h(-1),v=h(""),x=J(()=>D(r.modelValue));function _(e){const n=D(e);y("update:modelValue",n)}function A(e){const n=String(e).trim().toLowerCase();return x.value.some(t=>t.toLowerCase()===n)}function C(e){const n=String(e||"").trim();if(n){if(A(n)){o.value="",b();return}_([...x.value,n]),o.value="",b()}}function M(e){const n=x.value.filter(t=>t.toLowerCase()!==String(e).toLowerCase());_(n)}function P(){s.value.length>0&&(f.value=!0)}function b(){f.value=!1,u.value=-1}function L(e){if(r.disabled)return;const n=e.key;if(n==="Enter"||n==="Tab"||n===","){if(u.value>=0&&u.value<s.value.length){e.preventDefault(),C(s.value[u.value]);return}const t=o.value;if(t){e.preventDefault(),C(t);return}}if(n==="ArrowDown"){if(!f.value){P();return}e.preventDefault();const t=Math.min(s.value.length-1,u.value+1);u.value=t;return}if(n==="ArrowUp"){if(!f.value)return;e.preventDefault();const t=Math.max(-1,u.value-1);u.value=t;return}n==="Escape"&&f.value&&(e.preventDefault(),b())}function $(e){C(e)}function j(){s.value.length&&(f.value=!0)}async function R(e,n,t){const T=encodeURIComponent(e),I=encodeURIComponent(String(n)),{data:w}=await p.get(`/api/v1/tags?search=${T}&limit=${I}`,{signal:t}),B=Array.isArray(w?.items)?w.items:Array.isArray(w)?w:[];return q(B)}const V=ie(async({signal:e},n)=>{g.value=!0,v.value="";try{const I=(await(typeof r.fetcher=="function"?r.fetcher:R)(n,r.limit,e)).filter(w=>!A(w));s.value=I.slice(0,r.limit),o.value.trim().length>0&&s.value.length>0?f.value=!0:b()}catch(t){t?.name!=="AbortError"&&(v.value=t?.message??"Failed to load suggestions.",b())}finally{g.value=!1}}),N=re(e=>{if(!e||!e.trim()){s.value=[],b();return}V.run(e.trim())},r.debounceMs);return E(o,e=>{u.value=-1,N(e)}),E(()=>r.modelValue,()=>{s.value=s.value.filter(e=>!A(e)),s.value.length===0&&b()}),Q(()=>{function e(n){if(!n)return;const t=document.getElementById("tag-picker-root");t&&(t.contains(n.target)||b())}window.addEventListener("click",e,{capture:!0})}),(e,n)=>(d(),m("div",ce,[c("div",de,[(d(!0),m(z,null,O(x.value,t=>(d(),m("div",{key:t,class:"inline-flex items-center gap-2 rounded-full bg-indigo-50 px-3 py-1 text-sm text-indigo-700"},[c("span",null,S(t),1),c("button",{type:"button",class:"opacity-70 hover:opacity-100",title:"Remove",disabled:a.disabled,onClick:T=>M(t)},"✕",8,fe)]))),128)),c("div",me,[W(c("input",{ref_key:"inputRef",ref:i,"onUpdate:modelValue":n[0]||(n[0]=t=>o.value=t),type:"text",placeholder:a.placeholder,disabled:a.disabled,class:"w-56 rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:opacity-60",onKeydown:L,onFocus:j},null,40,ge),[[X,o.value]]),f.value?(d(),m("div",pe,[g.value?(d(),m("div",ve,"Loading…")):v.value?(d(),m("div",be,S(v.value),1)):(d(!0),m(z,{key:2},O(s.value,(t,T)=>(d(),m("button",{key:t,type:"button",class:F(["block w-full cursor-pointer px-3 py-1.5 text-left text-sm hover:bg-gray-50",{"bg-gray-100":T===u.value}]),role:"option",onMousedown:Y(I=>$(t),["prevent"])},S(t),43,ye))),128))])):k("",!0)])]),n[1]||(n[1]=c("div",{class:"mt-1 text-xs text-gray-500"}," Press Enter, comma, or Tab to add a tag. Suggestions update as you type. ",-1))]))}},Ie=Object.freeze(["Todo","InProgress","Done"]),ke=Object.freeze(["Low","Medium","High"]),Ae=Object.freeze(["dueDate","priority","status","title","createdAt"]),Ce=Object.freeze(["asc","desc"]),_e=Object.freeze({pageNumber:1,pageSize:20}),De=Object.freeze([10,20,50,100]);export{_e as D,De as P,Ce as S,Ae as T,Te as _,Se as a,Ie as b,ke as c,re as d,ie as m};
